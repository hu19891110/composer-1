<html>
  <head>
    <title>Composer</title>
    <style>
      body { margin:0px; padding:0px;}
    </style>
    <script type="text/javascript" src="lib/composer.js"></script>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript">
      jQuery(function() {
        jQuery("canvas").attr("width", jQuery(document).width());
        jQuery("canvas").attr("height", jQuery(document).height());
        var instance = Composer(document.getElementById("example1"), {fps: 30});
        instance.renderer.start();
        
        node = Composer.create({}, [Composer.Renderable, Composer.Collidable]);
        node.setSize(100,100).setPos(10,10,0);
        
        node.drag = false;
        var mx=0,my=0;
        function calcMouse(ev) {
          mx = ev.clientX - (instance.canvas.offsetLeft - window.pageXOffset);
          my = ev.clientY - (instance.canvas.offsetTop  - window.pageYOffset);
        }
        
        node.render = function() {
          
          if (node.drag) {
            node.setPos(mx - node.drag.x,
                        my - node.drag.y);
          }
          
          this.composer.renderer.context.fillStyle = "#FFFFFF";
          this.composer.renderer.context.fillRect(node.getPos().x,
                                                  node.getPos().y,
                                                  node.getSize().width,
                                                  node.getSize().height);
        };
        
        jQuery(document).mousedown(function(ev) {
          if (node.collides.aabb(mx, my)) {
            node.drag = {x:mx-node.getPos().x, y:my-node.getPos().y};
          }
        });
        
        jQuery(document).mouseup(function(ev) {
            node.drag = false;
        });
        
        jQuery(document).mousemove(calcMouse);
        
      });
    </script>
  </head>
  <body>
      <canvas id="example1" width="600" height="300"></canvas>
  </body>
</html>
