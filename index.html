<!DOCTYPE html>
<html>
  <head>
    <title>Composer</title>
    <style>
      body { margin:0px; padding:0px;}
    </style>
    <script type="text/javascript" src="../carena/lib/carena.js"></script>
    <script type="text/javascript" src="lib/composer.js"></script>
    <script type="text/javascript" src="../cider/lib/cider.js"></script>

    <script src="lib/jquery.js"></script>
    <script type="text/javascript">
      jQuery(function() {

        var feature = carena.feature,
            renderer = carena.Build({}, [feature.Renderer], {
              canvas: document.getElementById("composer")
            }),
            camera = carena.Build({}, [feature.Camera, feature.DropManager], {
              renderer: renderer
            }),

            scene.add(node1.add(node1port))
              .add(node2.add(node2port).add(node2port2));

            setTimeout(function render() {
              camera.render();
              setTimeout(render, 10);
            }, 0);

            document.addEventListener("keydown", function(ev) {
              if (ev.keyCode === 78 && ev.ctrlKey === true) {
                ev.preventDefault();
                // spawn a new carena
                var editorWindow = BaseNode({
                  color: "blue",
                  x:100, y: 100,
                  height: 400,
                  width: 400
                },[] /* TODO: fix me */),
                editor       = carena.Build({
                  x:110,y:150, width: 380, height: 340
                }, [
                  feature.Node,
                  feature.RelativeToParent,
                  cider.feature.Textual,
                  cider.feature.Editable,
                ]),
                lineNumbers = carena.Build({},[
                  cider.feature.LineNumbers,
                  feature.RelativeToParent
                ]);

                camera.add(editorWindow.add(editor.add(lineNumbers)));
              }
            }, true);

      });
    </script>
  </head>
  <body>
      <canvas id="composer" width="600" height="600"></canvas>
  </body>
</html>
