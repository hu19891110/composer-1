<!DOCTYPE html>
<html>
  <head>
    <title>Composer</title>
    <style>
      body { margin:0px; padding:0px;}
    </style>
    <script type="text/javascript" src="../carena/lib/carena.js"></script>
    <script type="text/javascript" src="lib/composer.js"></script>
    <script type="text/javascript" src="../cider/lib/cider.js"></script>

    <script src="lib/jquery.js"></script>
    <script type="text/javascript">
      jQuery(function() {

        var feature = carena.feature,
            renderer = carena.Build({}, [feature.Renderer], {
              canvas: document.getElementById("composer")
            }),
            camera = carena.Build({}, [feature.Camera, feature.DropManager], {
              renderer: renderer
            }),
            BaseNode = carena.Design({}, [
              feature.Node,
              feature.Draggable,
              feature.RelativeToParent
            ]),
            scene     = window.scene = BaseNode();
            node1     = BaseNode(),
            node1port = BaseNode({}, [
              feature.RelativeToParent,
              composer.feature.Port
            ]),
            node2     = BaseNode(),
            node2port = BaseNode({}, [
              feature.RelativeToParent,
              feature.DropTarget,
              composer.feature.Port
            ]);

            // Hook it all up
            camera.target = scene;

            node1.width = node1.height = 100;
            node1.x     = node1.y      = 0;
            node1.color = "darkgrey";

            node1port.width = node1port.height = 20;
            node1port.x = node1port.y = 80;
            node1port.color = "green";

            node2.width = node2.height = 100;
            node2.x     = node2.y      = 200;
            node2.color = "darkgrey";

            node2port.width = node2port.height = 20;
            node2port.x = node2port.y = 200;
            node2port.color = "red";
            node2port.dropend = function(node, data){
              node2port.add(node);
            };

            var menuNode = BaseNode();
            menuNode.height = 20;
            menuNode.color = "grey";
            menuNode.width = renderer.canvas.width;
            camera.add(menuNode);

            scene.add(node1.add(node1port)).add(node2.add(node2port));

            setTimeout(function render() {
              camera.render();
              setTimeout(render, 0);
            }, 0);
      });
    </script>
  </head>
  <body>
      <canvas id="composer" width="600" height="600"></canvas>
  </body>
</html>
